title: Microsoft 365 Onedrive Malware File Upload
id: 70b680d6-a7b5-40a8-8b36-db2e87ed6704
status: experimental
description: Detects the occurrence of files uploaded to OneDrive being detected as Malware by the file scanning engine. Attackers can use File Sharing and Organization Repositories to spread laterally within the company and amplify their access. Users can inadvertently share these files without knowing their maliciousness, giving adversaries opportunity to gain initial access to other endpoints in the environment.
references:
    - https://www.elastic.co/guide/en/security/current/onedrive-malware-file-upload.html
    - https://learn.microsoft.com/en-us/defender-office-365/anti-malware-protection-for-spo-odfb-teams-about?view=o365-worldwide
author: Jay Tymchuk '@JayInfoSec'
date: 2024-08-20
tags:
    - attack.lateral-movement
    - attack.t1080
logsource:
    category: cloud
    product: o365
    service: onedrive
detection:
    selection:
        Workload: 'OneDrive'
        Operation: 'FileMalwareDetected'
    condition: selection
falsepositives:
    - Benign files can trigger signatures in the built-in virus protection
level: high